---
title: "ã€Webpackã€‘Squooshã§ç”»åƒã‚’ä¸€æ‹¬åœ§ç¸®"
emoji: "ğŸ¤³"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["#Webpack","#Node","#npm"]
published: true
---

# ã¯ã˜ã‚ã«
ä»Šã¾ã§Gulpã‚„imageminã‚’ä½¿ã£ã¦ç”»åƒã®ä¸€æ‹¬åœ§ç¸®ã‚’ã—ã¦ãã¾ã—ãŸãŒã€ä½¿ç”¨ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ä¾å­˜æ€§/è„†å¼±æ€§ã®å•é¡ŒãŒã‚ã‚Šä½¿ç”¨ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å¤‰æ›´ã‚’æ¤œè¨ã—ã¦ã„ã¾ã—ãŸã€‚
ãã‚“ãªä¸­GoogleãŒæä¾›ã™ã‚‹SquooshãŒnpmã‚„Webpackã§ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦ãŸã®ã§è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚

## è¦ä»¶
- `src/img`ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã‚’ç¶­æŒã—ã¦`dist/assets/img`ã«æ›¸ãå‡ºã™
- ç”»åƒã®è¿½åŠ æ™‚ã«å®Ÿè¡Œ
- å¯¾è±¡æ‹¡å¼µå­ã¯`png`,`jpg`

# ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
https://webpack.js.org/plugins/image-minimizer-webpack-plugin/
https://webpack.js.org/plugins/copy-webpack-plugin/

# Webpackã®è¨­å®š
```js:webpack.config.js
const CopyWebpackPlugin = require('copy-webpack-plugin');
const ImageMinimizerPlugin = require('image-minimizer-webpack-plugin');
const path = require('path');

const optimizer = {
  mode: "development",
  entry: path.resolve(__dirname, 'src/js/dummy.js'),
  output: {
    clean: true,
    path: path.resolve(__dirname, 'dist/assets/js'),
  },
  plugins: [
    new CopyWebpackPlugin({
      patterns: [{
        from: path.resolve(__dirname, 'src/img'),
        to: path.resolve(__dirname, 'dist/assets/img')
      }]
    }),
    new ImageMinimizerPlugin({
      test: /\.(png|jpe?g)$/i,
      minimizer: {
        implementation: ImageMinimizerPlugin.squooshMinify,
        options: {
          encodeOptions: {
            mozjpeg: {
              quality: 85,
            },
            oxipng: {
              level: 3,
              interlace: false,
            }
          },
        },
      },
    }),
  ]
}

module.exports = [
  optimizer
];

```

## è£œè¶³
- `dummy.js`ã‚’ç”¨æ„ã™ã‚‹ã“ã¨ã§ã²ã¨ã¾ãšentryã‚’é€šã™ã€‚ï¼ˆä¸­èº«ã¯ç©ºã§OKï¼‰
- `module.exports`ã§åˆ†ã‘ã¦ã‚‹ã®ã¯ã€ä»–ã«ã‚‚èµ°ã‚‰ã›ã‚‹moduleãŒã‚ã‚‹ã‹ã‚‰ã§ã™ğŸ’¦ï¼ˆä»–ã«ãªã„å ´åˆã¯ãã®ã¾ã¾`module.exports = {}`ã§æ›¸ã„ã¦å¤§ä¸ˆå¤«ã§ã™ï¼‰

# package.jsonã§å®Ÿè¡Œ

watchã•ã›ãŸã‹ã£ãŸã®ã§ã€ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒè¿½åŠ ã•ã‚ŒãŸã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```json:package.json
"compile:img": "webpack",
"watch:img": "onchange src/img/**/*.{jpg,png,gif,svg} -- webpack",
```

watchã§ã¯`jpg`ã¨`png`ä»¥å¤–ã‚‚æŒ‡å®šã—ã¦ã„ã¾ã™ãŒã€åœ§ç¸®ã¯ã•ã‚Œã¾ã›ã‚“ã€‚è¤‡è£½ã®ã¿ã§ã™ã€‚
ï¼ˆSquooshã®å¯¾è±¡å¤–ã§ã—ãŸ...æ®‹å¿µğŸ˜­ï¼‰
